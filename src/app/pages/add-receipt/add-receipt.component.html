<link rel="stylesheet" href="https://unpkg.com/ngx-bootstrap/datepicker/bs-datepicker.css">
<section class="content-header card">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-sm-6">
        <h1>Add Receipt</h1>
      </div>
      <div class="col-sm-6">
        <ol class="breadcrumb float-sm-right">
          <li class="breadcrumb-item"><a href="#">Home</a></li>
          <li class="breadcrumb-item active">Add Receipt</li>
        </ol>
      </div>
    </div>
  </div><!-- /.container-fluid -->
</section><div class="container card">
  <div class="row">
    <div class="col-md-8">
      <input type="text" class="form-control" [(ngModel)]="textSearch" placeholder="Type here to search..."/>
    </div>
    <div class="col-md-4 pull-right">
      <button type="button" class="btn btn-sm btn-primary" (click)="backToReceipt()">
        <i class="fas fa-arrow-left"></i>  Back
      </button>
    </div>
  </div>
  <div>
    <form  (ngSubmit)="onSubmit()" class="form-horizontal" role="form" [formGroup] = 'frmReicipt' autocomplete="off">
  <div class="row">
    <div class="col-md-2">
      <label for="customerName">Customer Name :</label>&nbsp;<i class="fa fa-asterisk" style="color:red; font-size:10px;"></i>
    </div>
    <div class="col-md-5">
      <div class="form-group">
        <input type="text" name="customerName" class="form-control" formControlName="customerName" id="customerName" placeholder="Customer name" [ngClass]="{ 'is-invalid': submitted && f.customerName.errors }"/>
        <div *ngIf="submitted && f.customerName.errors" class="text-danger">
          <div *ngIf="f.customerName.errors.required"> Please enter customer name.</div>
        </div>
      </div>
    </div>
    <div class="col-md-2">
      <label for="receiptDate">Receipt Date :</label>&nbsp;<i class="fa fa-asterisk" style="color:red; font-size:10px;"></i>
    </div>
    <div class="col-md-3">
      <div class="form-group">
        <input type="text" name="receiptDate" [bsConfig]="{ dateInputFormat: 'DD-MM-YYYY', isAnimated: true,  adaptivePosition: true }" placeholder="Receipt date" class="form-control" formControlName="receiptDate" [ngClass]="{ 'is-invalid': submitted && f.receiptDate.errors }" bsDatepicker style="margin-left: -28px;">
        <div *ngIf="submitted && f.receiptDate.errors" class="text-danger">
          <div *ngIf="f.receiptDate.errors.required"> Please enter receipt name.</div>
        </div>
      </div>
    </div>
    <div class="col-md-1">
      <label for="gst" class="w-78">GST : (%)</label>
    </div>
      <div class="col-md-2">
        <input type="text" name="gst" class="form-control" formControlName="gst" id="gst" [(ngModel)]="gst" (ngModelChange)="claculateGST()" placeholder="GST"/>
    </div>
    <div class="col-md-1">
      <label for="cgst" class="w-78">CGST : (%)</label>
    </div>
      <div class="col-md-2">
        <input type="text" name="gst" class="form-control" formControlName="cgst" id="cgst" placeholder="CGST"/>
    </div>
    <div class="col-md-1">
      <label for="sgst" class="w-78">SGST : (%)</label>
    </div>
      <div class="col-md-2">
        <input type="text" name="sgst" class="form-control" formControlName="sgst" id="sgst" placeholder="SGST"/>
    </div>
    <div class="col-md-1">
      <label for="igst" class="w-78">IGST : (%)</label>
    </div>
      <div class="col-md-2">
        <input type="text" name="igst" class="form-control" formControlName="igst" id="igst" placeholder="IGST"/>
      </div>

    </div>
  <div class="row" style="margin-top: 20px">
    <div class="col-md-2">
      <label for="productName">Select Product</label>
    </div>
    <div class="col-md-3">
      <div class="form-group">
        <ng-select
         [items]="credits"
         name="productName"
          bindLabel="name"
          bindValue="name"
          formControlName="productName"
         placeholder="Select type" >
      </ng-select>

    </div>
  </div>
  <div class="col-md-1">
    <label for="quantity" class="w-78">Quantity :</label>
  </div>
    <div class="col-md-2">
      <input type="text" name="quantity" class="form-control" formControlName="quantity" id="quantity" placeholder="quantity"/>
    </div>
    <div class="col-md-1">
      <label for="rate" class="w-78">Rate :</label>
    </div>
      <div class="col-md-2">
        <input type="text" name="rate" class="form-control" formControlName="rate" id="rate" placeholder="rate"/>
      </div>
      <div class="col-md-1">
        <button type="button" class="btn btn-info btn-sm" (click)="calc()"><i class="fas fa-plus"></i> Add</button>
      </div>
  </div>
    </form>
  </div>
  <table class="table table-bordered table-striped" [hidden] ="true">
    <thead class="gradient">
      <tr>
        <th>#</th>
        <th>Date</th>
        <th>Buyer Name</th>
        <th>Receipt Amount</th>
        <th>Paid Amount</th>
        <th>Remaining Amount</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of credits| filter: textSearch | paginate: { itemsPerPage: 10, currentPage: p }; let i = index ">
        <td>{{i+1}}</td>
        <td>
          {{data.date}}
        </td>
        <td>{{data.name}}</td>
        <td>{{data.creditAmount}}</td>
        <td>{{data.paidAmount}}</td>
        <td>{{data.remainingAmount}}</td>
        <td>
          <i class="fas fa-edit text-primary curser" (click)="editCredit(data)" data-toggle="modal" data-target="#addCredit"></i> &nbsp;
          <i class="fas fa-trash text-danger curser" (click)="deleteCredit(data._id)"></i>
        </td>
      </tr>
    </tbody>
  </table>
  <!-- <pagination-controls (pageChange)="p = $event"></pagination-controls > -->
</div>

<div class="modal fade" bsModal #addCredit  id="addCredit" data-keyboard="false" data-backdrop="static">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header modal-head">
        <h4 class="modal-title">Add Receipt</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form  (ngSubmit)="onSubmit()" role="form" [formGroup] = 'frmCredit' autocomplete="off">
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="date">Receipt Date :</label>&nbsp;<i class="fa fa-asterisk" style="color:red; font-size:10px;"></i>
                <input type="text" [bsConfig]="{ dateInputFormat: 'DD-MM-YYYY', isAnimated: true,  adaptivePosition: true }" placeholder="Receipt date" class="form-control" formControlName="date" [ngClass]="{ 'is-invalid': submitted && f.date.errors }" bsDatepicker>
                <div *ngIf="submitted && f.date.errors" class="text-danger">
                  <div *ngIf="f.date.errors.required"> Please select date.</div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="name">Buyer Name :</label>&nbsp;<i class="fa fa-asterisk" style="color:red; font-size:10px;"></i>
                <input type="text" class="form-control" formControlName="name" id="name" placeholder="name" min="0" [ngClass]="{ 'is-invalid': submitted && f.name.errors }" />
                <div *ngIf="submitted && f.name.errors" class="text-danger">
                  <div *ngIf="f.name.errors.required"> Please enter name.</div>
                </div>
              </div>
            </div>

          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="creditAmount">Receipt Amount :</label>&nbsp;<i class="fa fa-asterisk" style="color:red; font-size:10px;"></i>
                <input type="number" class="form-control" formControlName="creditAmount" id="creditAmount" placeholder="Receipt amount" min="0" [ngClass]="{ 'is-invalid': submitted && f.creditAmount.errors }"/>
                <div *ngIf="submitted && f.creditAmount.errors" class="text-danger">
                  <div *ngIf="f.creditAmount.errors.required"> Please enter credit amount.</div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="paidAmount">Paid Amount :</label>&nbsp;<i class="fa fa-asterisk" style="color:red; font-size:10px;"></i>
                <input type="number" class="form-control" formControlName="paidAmount" id="paidAmount" placeholder="Paid amount" min="0"  [ngClass]="{ 'is-invalid': submitted && f.paidAmount.errors }"/>
                <div *ngIf="submitted && f.paidAmount.errors" class="text-danger">
                  <div *ngIf="f.paidAmount.errors.required"> Please enter paid amount.</div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="remainingAmount">Remaining Amount :</label>&nbsp;<i class="fa fa-asterisk" style="color:red; font-size:10px;"></i>
                <input type="number" class="form-control" formControlName="remainingAmount" id="remainingAmount" placeholder="Remaining amount" min="0" [ngClass]="{ 'is-invalid': submitted && f.remainingAmount.errors }"/>
                <div *ngIf="submitted && f.remainingAmount.errors" class="text-danger">
                  <div *ngIf="f.remainingAmount.errors.required"> Please enter remaining amount.</div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer ">
            <button type="submit" class="btn btn-primary btn-sm"><i class="fas fa-save"></i> Save</button>
            <button type="button" class="btn btn-danger btn-sm" data-dismiss="modal"><i class="fas fa-times"></i>Close</button>
          </div>
          <!-- /.card-body -->
        </form>
      </div>

    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
